!function(){"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeIcon()})),this._deleteButton=this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardImageEl.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}_handleLikeIcon(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}_getCardElement(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}generateDefaultCard(){return this._cardElement=this._getCardElement(),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._cardTitleEl.textContent=this._name,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._submitButton=t.querySelector(this._submitButtonSelector),this._inputList=Array.from(t.querySelectorAll(this._inputSelector))}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}resetButtonState(){this._toggleButtonState()}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_checkFormValidity(){return this._inputList.every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e){this._popupElement=document.querySelector(e),this._handlesEscClose=this._handlesEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handlesEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handlesEscClose)}_handlesEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal")&&this.close()})),this._popupElement.querySelector(".modal__close-button").addEventListener("click",(()=>{this.close()}))}}class r extends s{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t}_getInputValues(){return this._inputList=this._popupForm.querySelectorAll(".modal__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}close(){super.close(),this._popupForm.reset()}}document.querySelectorAll(".modal");const n=document.querySelector("#profile-edit-button"),o=(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input"),document.querySelector("#profile-description-input"),document.querySelector(".profile__add-button")),i=(document.querySelector("#add-card-title-input"),document.querySelector("#add-card-url-input"),document.querySelector("#add-new-card-save-button"),document.querySelector("#preview-image-close-button"),document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,{formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"}),a=(e,t)=>{h.open(e,t)};function l(t){const s=new e(t,"#card-template",a);c.addItem(s.generateDefaultCard())}const c=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:l},".cards__list");c.renderItems([{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}]);const u=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._headers=s,this._baseUrl=t}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{"Content-Type":this._contentType,_id:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>{e.ok?e.json():Promise.reject(`Error: ${e.status}`)})).catch((e=>{console.error(e)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9a60ea94-9d34-4f3e-83e3-c406b7fc4ac5","Content-Type":"application/json"}});console.log(u),u.getUserInfo().then((e=>{console.log(e)})),u.getInitialCards().then((e=>{console.log(e)})).catch((e=>{console.error(e)}));const d=new r("#add-new-card-modal",(function(e){l(e)}));d.setEventListeners();const _=new class{constructor(e,t){this._userNameElement=document.querySelector(e),this._userJobElement=document.querySelector(t)}getUserInfo(){return{name:this._userNameElement.textContent,job:this._userJobElement.textContent}}setUserInfo(e){this._userNameElement.textContent=e.title,this._userJobElement.textContent=e.description}}(".profile__title",".profile__description"),m=new r("#profile-edit-modal",(function(e){_.setUserInfo(e)}));m.setEventListeners();const h=new class extends s{constructor(e){super(e),this._popupImage=this._popupElement.querySelector("#preview-image"),this._popupCaption=this._popupElement.querySelector(".modal__preview-image-name")}open(e,t){this._popupImage.src=t,this._popupImage.alt=e,this._popupCaption.textContent=e,super.open()}}(".modal_preview-image");h.setEventListeners(),n.addEventListener("click",(()=>{const e=_.getUserInfo();document.querySelector(".modal__input_type_username").value=e.name,document.querySelector(".modal__input_type_userjob").value=e.job,p.disableButton(),m.open()})),o.addEventListener("click",(()=>{E.resetButtonState(),d.open()}));const p=new t(i,document.forms["profile-edit-form"]);p.enableValidation();const E=new t(i,document.forms["add-card-form"]);E.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFjL0IsRUFBS29KLFdBQzFDLEdIOEQ0QixrQkFBbUIseUJBRTNDQyxFQUFtQixJQUFJbEUsRUFDM0IsdUJBakJGLFNBQWlDd0QsR0FDL0JDLEVBQVNNLFlBQVlQLEVBQ3ZCLElBa0JBVSxFQUFpQnJFLG9CQUVqQixNQUFNa0IsRUFBb0IsSUlyRm5CLGNBQTZCM0IsRUFDbEN4RSxXQUFBQSxDQUFZcUYsR0FDVkUsTUFBTUYsR0FDTmpGLEtBQUttSixZQUFjbkosS0FBS3NFLGNBQWM3RCxjQUFjLGtCQUNwRFQsS0FBS29KLGNBQWdCcEosS0FBS3NFLGNBQWM3RCxjQUN0Qyw2QkFFSixDQUVBZ0UsSUFBQUEsQ0FBS3ZFLEVBQU1FLEdBQ1RKLEtBQUttSixZQUFZMUgsSUFBTXJCLEVBQ3ZCSixLQUFLbUosWUFBWXpILElBQU14QixFQUN2QkYsS0FBS29KLGNBQWN4SCxZQUFjMUIsRUFDakNpRixNQUFNVixNQUNSLEdKdUUyQyx3QkFDN0NzQixFQUFrQmxCLG9CQUdsQmMsRUFBa0I1RSxpQkFBaUIsU0FBUyxLQUMxQyxNQUFNc0ksRUFBT1osRUFBU1YsY0FDdEJ2SCxTQUFTQyxjQUFjLCtCQUErQmdGLE1BQVE0RCxFQUFLbkosS0FDbkVNLFNBQVNDLGNBQWMsOEJBQThCZ0YsTUFBUTRELEVBQUtQLElBQ2xFUSxFQUF5QjNGLGdCQUN6QnVGLEVBQWlCekUsTUFBTSxJQUd6Qm1CLEVBQWlCN0UsaUJBQWlCLFNBQVMsS0FDekN3SSxFQUFxQjdGLG1CQUNyQjZFLEVBQWdCOUQsTUFBTSxJQUd4QixNQUFNNkUsRUFBMkIsSUFBSXpILEVBQ25DZ0UsRUFDQXJGLFNBQVNnSixNQUFNLHNCQUVqQkYsRUFBeUJyRixtQkFFekIsTUFBTXNGLEVBQXVCLElBQUkxSCxFQUMvQmdFLEVBQ0FyRixTQUFTZ0osTUFBTSxrQkFFakJELEVBQXFCdEYsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2spIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vXCIuY2FyZF9fbGlrZS1idXR0b25cIlxyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgLy9cIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvL29wZW4gcHJldmlldyBpbWFnZVxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBfaGFuZGxlQ2FyZENsaWNrKCkge1xyXG4gIC8vICAgY29uc3QgaW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcclxuICAvLyAgIGNvbnN0IGltYWdlTW9kYWxJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2xhcmdlLXZpZXctaW1hZ2VcIik7XHJcbiAgLy8gICBpbWFnZU1vZGFsSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAvLyAgIGltYWdlTW9kYWxJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gIC8vICAgY29uc3QgaW1hZ2VNb2RhbFRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWltYWdlLW5hbWVcIik7XHJcbiAgLy8gICBpbWFnZU1vZGFsVGV4dC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gIC8vICAgb3Blbk1vZGFsKGltYWdlTW9kYWwpO1xyXG4gIC8vIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29uKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgX2dldENhcmRFbGVtZW50KCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZURlZmF1bHRDYXJkKCkge1xyXG4gICAgLy9nZXQgdGhlIGNhcmRcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0Q2FyZEVsZW1lbnQoKTtcclxuICAgIC8vc2V0IGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAvLyBSZXR1cm4gdGhlIGVsZW1lbnRcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Iob2JqLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IG9iai5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBvYmouc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gb2JqLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBvYmouaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IG9iai5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBjb25zdCBpc0Zvcm1WYWxpZCA9IHRoaXMuX2NoZWNrRm9ybVZhbGlkaXR5KCk7XHJcblxyXG4gICAgaWYgKGlzRm9ybVZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzZXRCdXR0b25TdGF0ZSgpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrRm9ybVZhbGlkaXR5KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoZm9ybVNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGZvcm1TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVzRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVzRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZXNFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlc0VzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVzRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgIC8vICBpZiAoXHJcbiAgICAvLyAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIikgfHxcclxuICAgIC8vICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIilcclxuICAgIC8vICApIHtcclxuICAgIC8vICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIC8vICB9XHJcbiAgICAvLyB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcblxyXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuLy8gRWxlbWVudHNcclxuZXhwb3J0IGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG4vLyBleHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xyXG4vLyBleHBvcnQgY29uc3QgZWRpdE1vZGFsQ2xvc2VCdXR0b24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbi8vICBcIiNtb2RhbC1jbG9zZS1idXR0b25cIlxyXG4vLyApO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcbi8vIGV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI2FkZC1jYXJkLXRpdGxlLWlucHV0XCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRVcmxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtdXJsLWlucHV0XCIpO1xyXG4vLyBleHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24gPSBhZGROZXdDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcclxuLy8gXCIjYWRkLWNhcmQtY2xvc2UtYnV0dG9uXCJcclxuLy8gKTtcclxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRTYXZlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNhZGQtbmV3LWNhcmQtc2F2ZS1idXR0b25cIlxyXG4pO1xyXG4vLyBleHBvcnQgY29uc3QgYWRkQ2FyZEZvcm0gPSBhZGROZXdDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuLy8gZXhwb3J0IGNvbnN0IGNhcmRUaXRsZUlucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcclxuLy8gICBcIiNhZGQtY2FyZC10aXRsZS1pbnB1dFwiXHJcbi8vICk7XHJcbi8vIGV4cG9ydCBjb25zdCBjYXJkVXJsSW5wdXQgPSBhZGRDYXJkRm9ybS5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLXVybC1pbnB1dFwiKTtcclxuLy8gZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3ByZXZpZXctaW1hZ2UtY2xvc2UtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPVxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG5cclxuLy9TZWxlY3RvcnNcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0U2VsZWN0b3IgPSBcIi5jYXJkc19fbGlzdFwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZ09iaiA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3NhdmUtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgY2FyZExpc3RTZWxlY3RvcixcclxuICBjb25maWdPYmosXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgaW5pdGlhbENhcmRzLFxyXG4gIGFkZE5ld0NhcmRCdXR0b24sXHJcbiAgYWRkTmV3Q2FyZFNhdmVCdXR0b24sXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuXHJcbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IChuYW1lLCBsaW5rKSA9PiB7XHJcbiAgcHJldmlld0ltYWdlTW9kYWwub3BlbihuYW1lLCBsaW5rKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgaGFuZGxlQ2FyZENsaWNrKTtcclxuICAvLyBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVEZWZhdWx0Q2FyZCgpO1xyXG4gIC8vIGNhcmRMaXN0RWxlbWVudC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICBjYXJkTGlzdC5hZGRJdGVtKGNhcmQuZ2VuZXJhdGVEZWZhdWx0Q2FyZCgpKTtcclxufVxyXG5cclxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcclxuICB9LFxyXG4gIGNhcmRMaXN0U2VsZWN0b3JcclxuKTtcclxuXHJcbmNhcmRMaXN0LnJlbmRlckl0ZW1zKGluaXRpYWxDYXJkcyk7XHJcblxyXG4vLyBmdW5jdGlvbiByZW5kZXJDYXJkcygpIHtcclxuLy8gICByZXR1cm4gUHJvbWlzZS5hbGwodXNlckluZm8sIGNhcmRzTGlzdCk7XHJcbi8vIH1cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjlhNjBlYTk0LTlkMzQtNGYzZS04M2UzLWM0MDZiN2ZjNGFjNVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5jb25zb2xlLmxvZyhhcGkpO1xyXG5cclxuYXBpLmdldFVzZXJJbmZvKCkudGhlbigocmVzKSA9PiB7XHJcbiAgY29uc29sZS5sb2cocmVzKTtcclxufSk7XHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsgLy8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxyXG4gIH0pO1xyXG5cclxuLy8gRXZlbnQgSGFuZGxlcnNcclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRzKSB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTmV3Q2FyZFN1Ym1pdChpbnB1dHMpIHtcclxuICByZW5kZXJDYXJkKGlucHV0cyk7XHJcbn1cclxuXHJcbmNvbnN0IGFkZE5ld0NhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI2FkZC1uZXctY2FyZC1tb2RhbFwiLFxyXG4gIGhhbmRsZU5ld0NhcmRTdWJtaXRcclxuKTtcclxuYWRkTmV3Q2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxyXG4pO1xyXG5wcm9maWxlRWRpdE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5tb2RhbF9wcmV2aWV3LWltYWdlXCIpO1xyXG5wcmV2aWV3SW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gRXZlbnQgTGlzdGVuZXJzXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV91c2VybmFtZVwiKS52YWx1ZSA9IGluZm8ubmFtZTtcclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX3VzZXJqb2JcIikudmFsdWUgPSBpbmZvLmpvYjtcclxuICBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xyXG4gIHByb2ZpbGVFZGl0TW9kYWwub3BlbigpO1xyXG59KTtcclxuXHJcbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkRm9ybVZhbGlkYXRvci5yZXNldEJ1dHRvblN0YXRlKCk7XHJcbiAgYWRkTmV3Q2FyZE1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25maWdPYmosXHJcbiAgZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWVkaXQtZm9ybVwiXVxyXG4pO1xyXG5wcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25maWdPYmosXHJcbiAgZG9jdW1lbnQuZm9ybXNbXCJhZGQtY2FyZC1mb3JtXCJdXHJcbik7XHJcbmFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoZGF0YSkge1xyXG4gICAgZGF0YS5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgLy8gYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogdGhpcy5fY29udGVudFR5cGUsXHJcbiAgICAgICAgLy8gbmFtZTogXCJcIixcclxuICAgICAgICAvLyBsaW5rOiBcIlwiLFxyXG4gICAgICAgIF9pZDogdGhpcy5fdG9rZW4sXHJcbiAgICAgIH0sXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHsgaGVhZGVyczogdGhpcy5faGVhZGVycyB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih1c2VyTmFtZVNlbGVjdG9yLCB1c2VySm9iU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3VzZXJOYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl91c2VySm9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckpvYlNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgdXNlckluZm8gPSB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX3VzZXJOYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl91c2VySm9iRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgICByZXR1cm4gdXNlckluZm87XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLnRpdGxlO1xyXG4gICAgdGhpcy5fdXNlckpvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLmRlc2NyaXB0aW9uO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LWltYWdlXCIpO1xyXG4gICAgdGhpcy5fcG9wdXBDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LWltYWdlLW5hbWVcIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBDYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJfY2FyZEVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VJY29uIiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2NhcmRJbWFnZUVsIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicmVtb3ZlIiwiX2dldENhcmRFbGVtZW50IiwiZ2VuZXJhdGVEZWZhdWx0Q2FyZCIsInNyYyIsImFsdCIsIl9jYXJkVGl0bGVFbCIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsIm9iaiIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3N1Ym1pdEJ1dHRvbiIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9jaGVja0Zvcm1WYWxpZGl0eSIsImRpc2FibGVkIiwicmVzZXRCdXR0b25TdGF0ZSIsImRpc2FibGVCdXR0b24iLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwiZm9ybVNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVzRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwicG9wdXBTZWxlY3RvciIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGROZXdDYXJkQnV0dG9uIiwiY29uZmlnT2JqIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJwcmV2aWV3SW1hZ2VNb2RhbCIsInJlbmRlckNhcmQiLCJjYXJkRGF0YSIsImNhcmQiLCJjYXJkTGlzdCIsImFkZEl0ZW0iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2hlYWRlcnMiLCJfYmFzZVVybCIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiX2NvbnRlbnRUeXBlIiwiX2lkIiwiX3Rva2VuIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRVc2VySW5mbyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiYXV0aG9yaXphdGlvbiIsImxvZyIsInJlc3VsdCIsImFkZE5ld0NhcmRNb2RhbCIsImlucHV0cyIsInVzZXJJbmZvIiwidXNlck5hbWVTZWxlY3RvciIsInVzZXJKb2JTZWxlY3RvciIsIl91c2VyTmFtZUVsZW1lbnQiLCJfdXNlckpvYkVsZW1lbnQiLCJqb2IiLCJzZXRVc2VySW5mbyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwcm9maWxlRWRpdE1vZGFsIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBDYXB0aW9uIiwiaW5mbyIsInByb2ZpbGVFZGl0Rm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiZm9ybXMiXSwic291cmNlUm9vdCI6IiJ9