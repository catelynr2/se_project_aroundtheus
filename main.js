!function(){"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeIcon()})),this._deleteButton=this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardImageEl.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}_handleLikeIcon(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}_getCardElement(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}generateDefaultCard(){return this._cardElement=this._getCardElement(),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._cardTitleEl.textContent=this._name,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._submitButton=t.querySelector(this._submitButtonSelector),this._inputList=Array.from(t.querySelectorAll(this._inputSelector))}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}resetButtonState(){this._toggleButtonState()}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_checkFormValidity(){return this._inputList.every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e){this._popupElement=document.querySelector(e),this._handlesEscClose=this._handlesEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handlesEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handlesEscClose)}_handlesEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal")&&this.close()})),this._popupElement.querySelector(".modal__close-button").addEventListener("click",(()=>{this.close()}))}}class n extends s{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t}_getInputValues(){return this._inputList=this._popupForm.querySelectorAll(".modal__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}close(){super.close(),this._popupForm.reset()}}document.querySelectorAll(".modal");const r=document.querySelector("#profile-edit-button"),o=(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input"),document.querySelector("#profile-description-input"),document.querySelector(".profile__add-button")),i=(document.querySelector("#add-card-title-input"),document.querySelector("#add-card-url-input"),document.querySelector("#add-new-card-save-button"),document.querySelector("#preview-image-close-button"),document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,{formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"}),a=(e,t)=>{_.open(e,t)};function l(t){const s=new e(t,"#card-template",a);c.addItem(s.generateDefaultCard())}const c=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:l},".cards__list");c.renderItems([{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}]),new class{constructor(e){}getInitialCards(){return fetch("https://around-api.en.tripleten-services.com/v1/cards",{headers:{authorization:"9a60ea94-9d34-4f3e-83e3-c406b7fc4ac5","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){fetch("https://around-api.en.tripleten-services.com/v1/users/me",{headers:{name:"",about:"",avatar:"",_id:"9a60ea94-9d34-4f3e-83e3-c406b7fc4ac5"}})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9a60ea94-9d34-4f3e-83e3-c406b7fc4ac5","Content-Type":"application/json"}}).getInitialCards().then((e=>{})).catch((e=>{console.error(e)}));const u=new n("#add-new-card-modal",(function(e){l(e)}));u.setEventListeners();const d=new class{constructor(e,t){this._userNameElement=document.querySelector(e),this._userJobElement=document.querySelector(t)}getUserInfo(){return{name:this._userNameElement.textContent,job:this._userJobElement.textContent}}setUserInfo(e){this._userNameElement.textContent=e.title,this._userJobElement.textContent=e.description}}(".profile__title",".profile__description"),m=new n("#profile-edit-modal",(function(e){d.setUserInfo(e)}));m.setEventListeners();const _=new class extends s{constructor(e){super(e),this._popupImage=this._popupElement.querySelector("#preview-image"),this._popupCaption=this._popupElement.querySelector(".modal__preview-image-name")}open(e,t){this._popupImage.src=t,this._popupImage.alt=e,this._popupCaption.textContent=e,super.open()}}(".modal_preview-image");_.setEventListeners(),r.addEventListener("click",(()=>{const e=d.getUserInfo();document.querySelector(".modal__input_type_username").value=e.name,document.querySelector(".modal__input_type_userjob").value=e.job,p.disableButton(),m.open()})),o.addEventListener("click",(()=>{h.resetButtonState(),u.open()}));const p=new t(i,document.forms["profile-edit-form"]);p.enableValidation();const h=new t(i,document.forms["add-card-form"]);h.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFBWXZILElBQU1yQixFQUN2QkosS0FBS2dKLFlBQVl0SCxJQUFNeEIsRUFDdkJGLEtBQUtpSixjQUFjckgsWUFBYzFCLEVBQ2pDaUYsTUFBTVYsTUFDUixHSjZEMkMsd0JBQzdDc0IsRUFBa0JsQixvQkFHbEJjLEVBQWtCNUUsaUJBQWlCLFNBQVMsS0FDMUMsTUFBTW1JLEVBQU9aLEVBQVNaLGNBQ3RCbEgsU0FBU0MsY0FBYywrQkFBK0JnRixNQUFReUQsRUFBS2hKLEtBQ25FTSxTQUFTQyxjQUFjLDhCQUE4QmdGLE1BQVF5RCxFQUFLUCxJQUNsRVEsRUFBeUJ4RixnQkFDekJvRixFQUFpQnRFLE1BQU0sSUFHekJtQixFQUFpQjdFLGlCQUFpQixTQUFTLEtBQ3pDcUksRUFBcUIxRixtQkFDckIwRSxFQUFnQjNELE1BQU0sSUFHeEIsTUFBTTBFLEVBQTJCLElBQUl0SCxFQUNuQ2dFLEVBQ0FyRixTQUFTNkksTUFBTSxzQkFFakJGLEVBQXlCbEYsbUJBRXpCLE1BQU1tRixFQUF1QixJQUFJdkgsRUFDL0JnRSxFQUNBckYsU0FBUzZJLE1BQU0sa0JBRWpCRCxFQUFxQm5GLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvL1wiLmNhcmRfX2xpa2UtYnV0dG9uXCJcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbigpO1xyXG4gICAgICB9KTtcclxuICAgIC8vXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy9vcGVuIHByZXZpZXcgaW1hZ2VcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gX2hhbmRsZUNhcmRDbGljaygpIHtcclxuICAvLyAgIGNvbnN0IGltYWdlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XHJcbiAgLy8gICBjb25zdCBpbWFnZU1vZGFsSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19sYXJnZS12aWV3LWltYWdlXCIpO1xyXG4gIC8vICAgaW1hZ2VNb2RhbEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgLy8gICBpbWFnZU1vZGFsSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAvLyAgIGNvbnN0IGltYWdlTW9kYWxUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZS1uYW1lXCIpO1xyXG4gIC8vICAgaW1hZ2VNb2RhbFRleHQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAvLyAgIG9wZW5Nb2RhbChpbWFnZU1vZGFsKTtcclxuICAvLyB9XHJcblxyXG4gIF9oYW5kbGVMaWtlSWNvbigpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIF9nZXRDYXJkRWxlbWVudCgpIHtcclxuICAgIHJldHVybiBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVEZWZhdWx0Q2FyZCgpIHtcclxuICAgIC8vZ2V0IHRoZSBjYXJkXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldENhcmRFbGVtZW50KCk7XHJcbiAgICAvL3NldCBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgLy8gUmV0dXJuIHRoZSBlbGVtZW50XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKG9iaiwgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBvYmouaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gb2JqLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IG9iai5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gb2JqLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBvYmouZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgY29uc3QgaXNGb3JtVmFsaWQgPSB0aGlzLl9jaGVja0Zvcm1WYWxpZGl0eSgpO1xyXG5cclxuICAgIGlmIChpc0Zvcm1WYWxpZCkge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlc2V0QnV0dG9uU3RhdGUoKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9jaGVja0Zvcm1WYWxpZGl0eSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1TZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlc0VzY0Nsb3NlID0gdGhpcy5faGFuZGxlc0VzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVzRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZXNFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlc0VzY0Nsb3NlKGV2dCkge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAvLyAgaWYgKFxyXG4gICAgLy8gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2UtYnV0dG9uXCIpIHx8XHJcbiAgICAvLyAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpXHJcbiAgICAvLyAgKSB7XHJcbiAgICAvLyAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAvLyAgfVxyXG4gICAgLy8gfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG5cclxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbi8vIEVsZW1lbnRzXHJcbmV4cG9ydCBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcclxuLy8gZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuLy8gZXhwb3J0IGNvbnN0IGVkaXRNb2RhbENsb3NlQnV0dG9uID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4vLyAgXCIjbW9kYWwtY2xvc2UtYnV0dG9uXCJcclxuLy8gKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG4vLyBleHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNhZGQtY2FyZC10aXRsZS1pbnB1dFwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkVXJsSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLXVybC1pbnB1dFwiKTtcclxuLy8gZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbENsb3NlQnV0dG9uID0gYWRkTmV3Q2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbi8vIFwiI2FkZC1jYXJkLWNsb3NlLWJ1dHRvblwiXHJcbi8vICk7XHJcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkU2F2ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjYWRkLW5ldy1jYXJkLXNhdmUtYnV0dG9uXCJcclxuKTtcclxuLy8gZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gYWRkTmV3Q2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbi8vIGV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbi8vICAgXCIjYWRkLWNhcmQtdGl0bGUtaW5wdXRcIlxyXG4vLyApO1xyXG4vLyBleHBvcnQgY29uc3QgY2FyZFVybElucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC11cmwtaW5wdXRcIik7XHJcbi8vIGV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZUNsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcmV2aWV3LWltYWdlLWNsb3NlLWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID1cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcclxuXHJcbi8vU2VsZWN0b3JzXHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdFNlbGVjdG9yID0gXCIuY2FyZHNfX2xpc3RcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBjb25maWdPYmogPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGNhcmRMaXN0U2VsZWN0b3IsXHJcbiAgY29uZmlnT2JqLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIGluaXRpYWxDYXJkcyxcclxuICBhZGROZXdDYXJkQnV0dG9uLFxyXG4gIGFkZE5ld0NhcmRTYXZlQnV0dG9uLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcblxyXG5jb25zdCBoYW5kbGVDYXJkQ2xpY2sgPSAobmFtZSwgbGluaykgPT4ge1xyXG4gIHByZXZpZXdJbWFnZU1vZGFsLm9wZW4obmFtZSwgbGluayk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGNhcmREYXRhLCBcIiNjYXJkLXRlbXBsYXRlXCIsIGhhbmRsZUNhcmRDbGljayk7XHJcbiAgLy8gY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlRGVmYXVsdENhcmQoKTtcclxuICAvLyBjYXJkTGlzdEVsZW1lbnQucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgY2FyZExpc3QuYWRkSXRlbShjYXJkLmdlbmVyYXRlRGVmYXVsdENhcmQoKSk7XHJcbn1cclxuXHJcbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgcmVuZGVyZXI6IHJlbmRlckNhcmQsXHJcbiAgfSxcclxuICBjYXJkTGlzdFNlbGVjdG9yXHJcbik7XHJcblxyXG5jYXJkTGlzdC5yZW5kZXJJdGVtcyhpbml0aWFsQ2FyZHMpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiOWE2MGVhOTQtOWQzNC00ZjNlLTgzZTMtYzQwNmI3ZmM0YWM1XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmFwaVxyXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgIC8vIHByb2Nlc3MgdGhlIHJlc3VsdFxyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsgLy8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxyXG4gIH0pO1xyXG5cclxuLy8gRXZlbnQgSGFuZGxlcnNcclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRzKSB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTmV3Q2FyZFN1Ym1pdChpbnB1dHMpIHtcclxuICByZW5kZXJDYXJkKGlucHV0cyk7XHJcbn1cclxuXHJcbmNvbnN0IGFkZE5ld0NhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI2FkZC1uZXctY2FyZC1tb2RhbFwiLFxyXG4gIGhhbmRsZU5ld0NhcmRTdWJtaXRcclxuKTtcclxuYWRkTmV3Q2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxyXG4pO1xyXG5wcm9maWxlRWRpdE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5tb2RhbF9wcmV2aWV3LWltYWdlXCIpO1xyXG5wcmV2aWV3SW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gRXZlbnQgTGlzdGVuZXJzXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV91c2VybmFtZVwiKS52YWx1ZSA9IGluZm8ubmFtZTtcclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX3VzZXJqb2JcIikudmFsdWUgPSBpbmZvLmpvYjtcclxuICBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xyXG4gIHByb2ZpbGVFZGl0TW9kYWwub3BlbigpO1xyXG59KTtcclxuXHJcbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkRm9ybVZhbGlkYXRvci5yZXNldEJ1dHRvblN0YXRlKCk7XHJcbiAgYWRkTmV3Q2FyZE1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25maWdPYmosXHJcbiAgZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWVkaXQtZm9ybVwiXVxyXG4pO1xyXG5wcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25maWdPYmosXHJcbiAgZG9jdW1lbnQuZm9ybXNbXCJhZGQtY2FyZC1mb3JtXCJdXHJcbik7XHJcbmFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoZGF0YSkge1xyXG4gICAgZGF0YS5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIC8vIGNvbnN0cnVjdG9yIGJvZHlcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzXCIsIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiOWE2MGVhOTQtOWQzNC00ZjNlLTgzZTMtYzQwNmI3ZmM0YWM1XCIsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgLy8gbmFtZTogXCJcIixcclxuICAgICAgICAvLyBsaW5rOiBcIlwiLFxyXG4gICAgICAgIC8vIF9pZDogXCJcIixcclxuICAgICAgfSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gaWYgdGhlIHNlcnZlciByZXR1cm5zIGFuIGVycm9yLCByZWplY3QgdGhlIHByb21pc2VcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgZmV0Y2goXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS91c2Vycy9tZVwiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBuYW1lOiBcIlwiLFxyXG4gICAgICAgIGFib3V0OiBcIlwiLFxyXG4gICAgICAgIGF2YXRhcjogXCJcIixcclxuICAgICAgICBfaWQ6IFwiOWE2MGVhOTQtOWQzNC00ZjNlLTgzZTMtYzQwNmI3ZmM0YWM1XCIsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmRzKCkge1xyXG4gIHJldHVybiBQcm9taXNlLmFsbCh1c2VySW5mbywgY2FyZHNMaXN0KTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IodXNlck5hbWVTZWxlY3RvciwgdXNlckpvYlNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fdXNlckpvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJKb2JTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJJbmZvID0ge1xyXG4gICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIGpvYjogdGhpcy5fdXNlckpvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oZGF0YSkge1xyXG4gICAgdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS50aXRsZTtcclxuICAgIHRoaXMuX3VzZXJKb2JFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5kZXNjcmlwdGlvbjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZVwiKTtcclxuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fcHJldmlldy1pbWFnZS1uYW1lXCJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlSWNvbiIsIl9kZWxldGVCdXR0b24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9jYXJkSW1hZ2VFbCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsIl9nZXRDYXJkRWxlbWVudCIsImdlbmVyYXRlRGVmYXVsdENhcmQiLCJzcmMiLCJhbHQiLCJfY2FyZFRpdGxlRWwiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJvYmoiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zdWJtaXRCdXR0b24iLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yRWxlbWVudCIsImlkIiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJkaXNhYmxlZCIsInJlc2V0QnV0dG9uU3RhdGUiLCJkaXNhYmxlQnV0dG9uIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJQb3B1cCIsImZvcm1TZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlc0VzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsInBvcHVwU2VsZWN0b3IiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsInByb2ZpbGVFZGl0QnV0dG9uIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsImNvbmZpZ09iaiIsImZpcnN0RWxlbWVudENoaWxkIiwicHJldmlld0ltYWdlTW9kYWwiLCJyZW5kZXJDYXJkIiwiY2FyZERhdGEiLCJjYXJkIiwiY2FyZExpc3QiLCJhZGRJdGVtIiwiX3JlZiIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJvcHRpb25zIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJhYm91dCIsImF2YXRhciIsIl9pZCIsImJhc2VVcmwiLCJyZXN1bHQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImFkZE5ld0NhcmRNb2RhbCIsImlucHV0cyIsInVzZXJJbmZvIiwidXNlck5hbWVTZWxlY3RvciIsInVzZXJKb2JTZWxlY3RvciIsIl91c2VyTmFtZUVsZW1lbnQiLCJfdXNlckpvYkVsZW1lbnQiLCJqb2IiLCJzZXRVc2VySW5mbyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwcm9maWxlRWRpdE1vZGFsIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBDYXB0aW9uIiwiaW5mbyIsInByb2ZpbGVFZGl0Rm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiZm9ybXMiXSwic291cmNlUm9vdCI6IiJ9